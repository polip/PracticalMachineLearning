---
title: "Practical Machine Learning Course Project"
author: "Ivan Lozo"
date: '15 svibnja 2017 '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

### Introduction

This is an Markdown document created with purpose to present results of predictive analyses on people personal activity. It is  created as result of Practical Machine Learning Course Project.
Data is provided by http://groupware.les.inf.puc-rio.br/har.
Purpose of the modelling is to predict the manner in which people did the exercise which is in "class" variable in the trainig set.

### Importing data

For importing data we will use Hedley's readr package.

```{r,cache=TRUE}
library(readr)

training <- read_csv("~/R/PracticalMachineLearning1/pml-training.csv", 
col_types = cols(kurtosis_picth_arm = col_double(), 
       kurtosis_picth_belt = col_double(), 
       kurtosis_yaw_arm = col_double(), 
       kurtosis_yaw_belt = col_double(), 
       kurtosis_yaw_dumbbell = col_double(), 
        kurtosis_yaw_forearm = col_double(), 
        skewness_pitch_arm = col_double(), 
        skewness_roll_belt.1 = col_double(), 
        skewness_yaw_arm = col_double(), 
        skewness_yaw_belt = col_double(),
       skewness_yaw_dumbbell = col_double(),
       skewness_yaw_forearm = col_double()))
        

testing <- read.csv("pml-testing.csv")
```

### Data inspection 

Let's examine training data set that we will use for modelling.

Training dataset contains 19 622 rows and 160 columns
```{r}
dim(training)
```

```{r}
str(training)
```

```{r}
summary(training)
```

```{r}

head(training,n = 20)
```
Let's look at the distribution of target variable.
```{r}
table(training$classe)
```


First, we will remove also first 6 columns, since they don't contain usefull data.

```{r}
training <- training[, -(1:6)]
testing <- testing[, -(1:6)]
```

Then, we will remove columns with all missing variables.

```{r}
allmisscols <- apply(training,2, function(x)all(is.na(x)))
colswithallmiss <-names(allmisscols[allmisscols>0])

training <- training[, -which(names(training)%in%colswithallmiss)]
testing <- testing[, -which(names(testing)%in%colswithallmiss)]
```

We will also remove variables with NAs share above 90%.
```{r}
training <- training[,colMeans(is.na(training))<0.10]
testing <- testing[,colMeans(is.na(testing))<0.10]

```

Imputting mean for missing values.
```{r}

```

Since there are so many variables it is impossible to visualize them all,
so we will start with transformations in order to find highly corellated variables.

```{r}
library(corrplot)
library(caret)

trainingScale <- preProcess(training[,-148],method = c("center","scale"))
trainingTransformed <- predict(trainingScale,training)
trainingCor <- cor(trainingTransformed[,-148],use = "complete.obs")

highlyCor <- findCorrelation(trainingCor,cutoff = 0.8)

trainingScaled <- 
```
Target variable distribution.
```{r}
library(ggplot2)
qplot(training$classe)
```


